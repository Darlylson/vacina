<script>
  const tabela = document.querySelector("#tabela tbody");
  const pacientes = {
    "Darlylson do Socorro Brito dos Santos": "1972-12-07",
    "Daniel Souza dos Santos": "2014-02-28"
  };

  function preencherPaciente() {
    const select = document.getElementById("paciente-select");
    const nome = select.value;
    document.getElementById("nome").value = nome;
    document.getElementById("nascimento").value = pacientes[nome] || "";
    renderizarTabela();
  }

  function carregarDados() {
    return JSON.parse(localStorage.getItem("vacinas")) || [];
  }

  function salvarDados(dados) {
    localStorage.setItem("vacinas", JSON.stringify(dados));
  }

  function adicionarVacina() {
    const nome = document.getElementById("nome").value;
    const nascimento = document.getElementById("nascimento").value;
    const vacina = document.getElementById("vacina").value;
    const data = document.getElementById("data").value;
    const lote = document.getElementById("lote").value;
    const profissional = document.getElementById("profissional").value;

    if (nome && vacina && data && lote && profissional) {
      const dados = carregarDados();
      dados.push({ nome, nascimento, vacina, data, lote, profissional });
      salvarDados(dados);
      alert("Registro salvo com sucesso.");
      document.getElementById("vacina").value = "";
      document.getElementById("data").value = "";
      document.getElementById("lote").value = "";
      document.getElementById("profissional").value = "";
      renderizarTabela();
    } else {
      alert("Preencha todos os campos.");
    }
  }

  function renderizarTabela() {
    const dados = carregarDados();
    const pacienteAtual = document.getElementById("nome").value;
    tabela.innerHTML = "";

    const filtrados = dados.filter(d => d.nome === pacienteAtual);

    if (filtrados.length === 0) {
      tabela.innerHTML = "<tr><td colspan='5'>Nenhum registro encontrado.</td></tr>";
      return;
    }

    filtrados.forEach(item => {
      const row = `<tr>
        <td>${item.nome}</td>
        <td>${item.vacina}</td>
        <td>${item.data}</td>
        <td>${item.lote}</td>
        <td>${item.profissional}</td>
      </tr>`;
      tabela.innerHTML += row;
    });
  }

  window.onload = renderizarTabela;
</script>
